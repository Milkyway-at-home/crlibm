#include "crlibm.h"
#include "crlibm_private.h"
/*
 * Constant to compute the natural logarithm. 
 */


#define SQRT_2 1.4142135623730950489e0 

double const delta[8] = {1.0039215686, 1.0078740157, 1.0078740157, 1.0158730159, 1.0666666667, 1.0322580645,  1.0158730159,
			 1.0078740157};


#ifdef WORDS_BIGENDIAN
db_number const ln2hi = {{0x3FE62E42, 0xFEFA39EF}};
db_number const ln2lo = {{0x3C7ABC9E, 0x3B39803F}};

db_number const two52 = {{0x43300000, 0x00000000}};
  
 db_number const middle[8] =
{
{{0x3FE70000,0x0}},
{{0x3FE90000,0x0}},
{{0x3FEB0000,0x0}},
{{0x3FED0000,0x0}},
{{0x3FF00000,0x0}},
{{0x3FF20000,0x0}},
{{0x3FF40000,0x0}},
{{0x3FF60000,0x0}}
};


db_number const poly_log_fast_b[8][14] =
{
 /* polynome sur le 1 ieme intervalle */
{
{{0xBFD522AE,0x0738A3D8}},
{{0x3FF642C8,0x590B2164}},
{{0xBFEEF8BD,0xB389EBAD}},
{{0x3FECBA31,0xCF571E19}},
{{0xBFEDF9F1,0x31660998}},
{{0x3FF0AEB7,0x33EEF511}},
{{0xBFF3578D,0xEA99DCE5}},
{{0x3FF710F6,0x2E52105A}},
{{0xBFFC14A5,0xB42AAA3C}},
{{0x40015B19,0xAF0F7D2D}},
{{0xC005BD82,0x2DEA0210}},
{{0x401108DC,0x9FF858F0}},
{{0xC011FCF1,0x95280757}},
{{0xC06FA1D4,0x744B1AE7}}
},
 /* polynome sur le 2 ieme intervalle */
{
{{0xBFCF991C,0x6CB3B379}},
{{0x3FF47AE1,0x47AE147B}},
{{0xBFEA36E2,0xEB1C432D}},
{{0x3FE65E9F,0x80F2924E}},
{{0xBFE5798E,0xE2308C97}},
{{0x3FE5FD7F,0xE171CF04}},
{{0xBFE774CC,0xAC36EA7E}},
{{0x3FE9BC1F,0xDD4D83FF}},
{{0xBFECD2B2,0xC9AE7A4A}},
{{0x3FF0644E,0x06A6E220}},
{{0xBFF2E357,0x23165328}},
{{0x3FFA506C,0xD94AC18F}},
{{0xBFFA576B,0x6EB1CDBC}},
{{0xC054DB8D,0x996162BC}}
},
 /* polynome sur le 3 ieme intervalle */
{
{{0xBFC5BF40,0x6B543DB2}},
{{0x3FF2F684,0xBDA12F68}},
{{0xBFE67980,0xE0BF08C7}},
{{0x3FE1C1FA,0x5F67889A}},
{{0xBFDF91BD,0x1B62BA0D}},
{{0x3FDDEEAF,0x823D9C63}},
{{0xBFDD9015,0xA3671EC7}},
{{0x3FDE0836,0xC816B1C3}},
{{0xBFDF24F6,0x44684DE2}},
{{0x3FE066C6,0xC6D33D21}},
{{0xBFE17F7D,0x939473BB}},
{{0x3FE5F789,0x751C691B}},
{{0xBFE4DA14,0x891FAED0}},
{{0xC03DF296,0x5CAC1504}}
},
 /* polynome sur le 4 ieme intervalle */
{
{{0xBFB9335E,0x5D594989}},
{{0x3FF1A7B9,0x611A7B96}},
{{0xBFE37B48,0x24872747}},
{{0x3FDCA99C,0x29F8DE98}},
{{0xBFD7B881,0x3D36D9CE}},
{{0x3FD4F08E,0x55D11BED}},
{{0xBFD3413F,0x4633350E}},
{{0x3FD23625,0x1CF7A415}},
{{0xBFD194D8,0x8836E112}},
{{0x3FD13F02,0x879F3558}},
{{0xBFD30806,0x48EAF0EE}},
{{0x3FD169AE,0xF65E7367}},
{{0x4023C2D7,0xE736FD5D}},
{{0x00000000,0x00000000}}
},
 /* polynome sur le 5 ieme intervalle */
{
{{0x00000000,0x00000000}},
{{0x3FF00000,0x00000000}},
{{0xBFE00000,0x00000000}},
{{0x3FD55555,0x55555555}},
{{0xBFD00000,0x0000002A}},
{{0x3FC99999,0x99999A5E}},
{{0xBFC55555,0x55518B50}},
{{0x3FC24924,0x92430216}},
{{0xBFC00000,0x102811AF}},
{{0x3FBC71C7,0x467B503D}},
{{0xBFB9995B,0x596B1731}},
{{0x3FB7458B,0x79452E7E}},
{{0xBFB58C8C,0x4017A8D1}},
{{0x3FB3E915,0xEDDD619E}}
},
 /* polynome sur le 6 ieme intervalle */
{
{{0x3FBE2707,0x6E2AF2E6}},
{{0x3FEC71C7,0x1C71C71C}},
{{0xBFD948B0,0xFCD6E9E0}},
{{0x3FCDF756,0x80FEBDFE}},
{{0xBFC3FA39,0xAB5481BE}},
{{0x3FBC6990,0x982BBDE2}},
{{0xBFB50BD3,0x67505582}},
{{0x3FB00904,0x3A0BA83B}},
{{0xBFA8F193,0x5A96A8DD}},
{{0x3FA3AFF2,0x88EC225D}},
{{0xBF9F8691,0xC29F4BC0}},
{{0x3FA11831,0xF3B79A6A}},
{{0xBF958D5C,0xAFF238AA}},
{{0xBFE4E5E2,0x0C358DF7}}
},
 /* polynome sur le 7 ieme intervalle */
{
{{0x3FCC8FF7,0xC79A9A22}},
{{0x3FE99999,0x9999999A}},
{{0xBFD47AE1,0x47AE147B}},
{{0x3FC5D867,0xC3ECE483}},
{{0xBFBA36E2,0xEB1C46C7}},
{{0x3FB0C6F7,0xA09811CF}},
{{0xBFA65E9F,0x80D34A70}},
{{0x3F9EADA9,0x25C09CCA}},
{{0xBF95798F,0x5E4AAA27}},
{{0x3F8E856A,0xEC04A539}},
{{0xBF85FC96,0xFEF34F35}},
{{0x3F844211,0xF634A785}},
{{0xBF782888,0x6D761690}},
{{0xBFC47445,0x71371117}}
},
 /* polynome sur le 8 ieme intervalle */
{
{{0x3FD4618B,0xC21C5EC2}},
{{0x3FE745D1,0x745D1746}},
{{0xBFD0ECF5,0x6BE69C90}},
{{0x3FC069A8,0x2A920C2E}},
{{0xBFB1E7A0,0x2E70C783}},
{{0x3FA4D5AC,0x6DE4FAD6}},
{{0xBF99410F,0x10D682E5}},
{{0x3F8F7C55,0x46DC152E}},
{{0xBF84094D,0x8FC7AF09}},
{{0x3F79E7D3,0x7BF73FF3}},
{{0xBF70F4C4,0x7B6F81B6}},
{{0x3F666BD7,0x44DA9702}},
{{0xBF5E14E0,0xEB65BF41}},
{{0x3F54347E,0x6440A788}}
}
};

db_number const poly_log_fast_l[8][2] =
{
 /* polynome sur le 1 ieme intervalle */
{
{{0x3C68F7E3,0xF5B8C149}},
{{0x3C85D9AD,0x7FD6876A}}
},
 /* polynome sur le 2 ieme intervalle */
{
{{0xBC6F6652,0x2538C850}},
{{0xBC7EFDA9,0x8401C65A}}
},
 /* polynome sur le 3 ieme intervalle */
{
{{0x3C21F5AB,0x04C180BE}},
{{0x3C92F04A,0xE6601A9C}}
},
 /* polynome sur le 4 ieme intervalle */
{
{{0x3C547DBB,0xEC87FF20}},
{{0x3C719FCB,0x3F0AB1E3}}
},
 /* polynome sur le 5 ieme intervalle */
{
{{0x00000000,0x00000000}},
{{0x00000000,0x00000000}}
},
 /* polynome sur le 6 ieme intervalle */
{
{{0xBC361A58,0xD47979A0}},
{{0x3C881724,0x1D9E3083}}
},
 /* polynome sur le 7 ieme intervalle */
{
{{0xBC64F6AC,0x66E96EEA}},
{{0xBC8AAA98,0x23FD6EEE}}
},
 /* polynome sur le 8 ieme intervalle */
{
{{0x3C7F42DE,0xB2A221E5}},
{{0xBC7745D0,0xE95C768F}}
}
};

#else

db_number const ln2hi = {{0xFEFA39EF, 0x3FE62E42}};
db_number const ln2lo = {{0x3B39803F, 0x3C7ABC9E}};

db_number const two52 = {{0x00000000, 0x43300000}};
  
 db_number const middle[8] =
{
{{0x0, 0x3FE70000}},
{{0x0, 0x3FE90000}},
{{0x0, 0x3FEB0000}},
{{0x0, 0x3FED0000}},
{{0x0, 0x3FF00000}},
{{0x0, 0x3FF20000}},
{{0x0, 0x3FF40000}},
{{0x0, 0x3FF60000}}
};


db_number const poly_log_fast_b[8][14] =
{
 /* polynome sur le 1 ieme intervalle */
{
{{0x0738A3D8,0xBFD522AE}},
{{0x590B2164,0x3FF642C8}},
{{0xB389EBAD,0xBFEEF8BD}},
{{0xCF571E19,0x3FECBA31}},
{{0x31660998,0xBFEDF9F1}},
{{0x33EEF511,0x3FF0AEB7}},
{{0xEA99DCE5,0xBFF3578D}},
{{0x2E52105A,0x3FF710F6}},
{{0xB42AAA3C,0xBFFC14A5}},
{{0xAF0F7D2D,0x40015B19}},
{{0x2DEA0210,0xC005BD82}},
{{0x9FF858F0,0x401108DC}},
{{0x95280757,0xC011FCF1}},
{{0x744B1AE7,0xC06FA1D4}}
},
 /* polynome sur le 2 ieme intervalle */
{
{{0x6CB3B379,0xBFCF991C}},
{{0x47AE147B,0x3FF47AE1}},
{{0xEB1C432D,0xBFEA36E2}},
{{0x80F2924E,0x3FE65E9F}},
{{0xE2308C97,0xBFE5798E}},
{{0xE171CF04,0x3FE5FD7F}},
{{0xAC36EA7E,0xBFE774CC}},
{{0xDD4D83FF,0x3FE9BC1F}},
{{0xC9AE7A4A,0xBFECD2B2}},
{{0x06A6E220,0x3FF0644E}},
{{0x23165328,0xBFF2E357}},
{{0xD94AC18F,0x3FFA506C}},
{{0x6EB1CDBC,0xBFFA576B}},
{{0x996162BC,0xC054DB8D}}
},
 /* polynome sur le 3 ieme intervalle */
{
{{0x6B543DB2,0xBFC5BF40}},
{{0xBDA12F68,0x3FF2F684}},
{{0xE0BF08C7,0xBFE67980}},
{{0x5F67889A,0x3FE1C1FA}},
{{0x1B62BA0D,0xBFDF91BD}},
{{0x823D9C63,0x3FDDEEAF}},
{{0xA3671EC7,0xBFDD9015}},
{{0xC816B1C3,0x3FDE0836}},
{{0x44684DE2,0xBFDF24F6}},
{{0xC6D33D21,0x3FE066C6}},
{{0x939473BB,0xBFE17F7D}},
{{0x751C691B,0x3FE5F789}},
{{0x891FAED0,0xBFE4DA14}},
{{0x5CAC1504,0xC03DF296}}
},
 /* polynome sur le 4 ieme intervalle */
{
{{0x5D594989,0xBFB9335E}},
{{0x611A7B96,0x3FF1A7B9}},
{{0x24872747,0xBFE37B48}},
{{0x29F8DE98,0x3FDCA99C}},
{{0x3D36D9CE,0xBFD7B881}},
{{0x55D11BED,0x3FD4F08E}},
{{0x4633350E,0xBFD3413F}},
{{0x1CF7A415,0x3FD23625}},
{{0x8836E112,0xBFD194D8}},
{{0x879F3558,0x3FD13F02}},
{{0x48EAF0EE,0xBFD30806}},
{{0xF65E7367,0x3FD169AE}},
{{0xE736FD5D,0x4023C2D7}},
{{0x00000000,0x00000000}}
},
 /* polynome sur le 5 ieme intervalle */
{
{{0x00000000,0x00000000}},
{{0x00000000,0x3FF00000}},
{{0x00000000,0xBFE00000}},
{{0x55555555,0x3FD55555}},
{{0x0000002A,0xBFD00000}},
{{0x99999A5E,0x3FC99999}},
{{0x55518B50,0xBFC55555}},
{{0x92430216,0x3FC24924}},
{{0x102811AF,0xBFC00000}},
{{0x467B503D,0x3FBC71C7}},
{{0x596B1731,0xBFB9995B}},
{{0x79452E7E,0x3FB7458B}},
{{0x4017A8D1,0xBFB58C8C}},
{{0xEDDD619E,0x3FB3E915}}
},
 /* polynome sur le 6 ieme intervalle */
{
{{0x6E2AF2E6,0x3FBE2707}},
{{0x1C71C71C,0x3FEC71C7}},
{{0xFCD6E9E0,0xBFD948B0}},
{{0x80FEBDFE,0x3FCDF756}},
{{0xAB5481BE,0xBFC3FA39}},
{{0x982BBDE2,0x3FBC6990}},
{{0x67505582,0xBFB50BD3}},
{{0x3A0BA83B,0x3FB00904}},
{{0x5A96A8DD,0xBFA8F193}},
{{0x88EC225D,0x3FA3AFF2}},
{{0xC29F4BC0,0xBF9F8691}},
{{0xF3B79A6A,0x3FA11831}},
{{0xAFF238AA,0xBF958D5C}},
{{0x0C358DF7,0xBFE4E5E2}}
},
 /* polynome sur le 7 ieme intervalle */
{
{{0xC79A9A22,0x3FCC8FF7}},
{{0x9999999A,0x3FE99999}},
{{0x47AE147B,0xBFD47AE1}},
{{0xC3ECE483,0x3FC5D867}},
{{0xEB1C46C7,0xBFBA36E2}},
{{0xA09811CF,0x3FB0C6F7}},
{{0x80D34A70,0xBFA65E9F}},
{{0x25C09CCA,0x3F9EADA9}},
{{0x5E4AAA27,0xBF95798F}},
{{0xEC04A539,0x3F8E856A}},
{{0xFEF34F35,0xBF85FC96}},
{{0xF634A785,0x3F844211}},
{{0x6D761690,0xBF782888}},
{{0x71371117,0xBFC47445}}
},
 /* polynome sur le 8 ieme intervalle */
{
{{0xC21C5EC2,0x3FD4618B}},
{{0x745D1746,0x3FE745D1}},
{{0x6BE69C90,0xBFD0ECF5}},
{{0x2A920C2E,0x3FC069A8}},
{{0x2E70C783,0xBFB1E7A0}},
{{0x6DE4FAD6,0x3FA4D5AC}},
{{0x10D682E5,0xBF99410F}},
{{0x46DC152E,0x3F8F7C55}},
{{0x8FC7AF09,0xBF84094D}},
{{0x7BF73FF3,0x3F79E7D3}},
{{0x7B6F81B6,0xBF70F4C4}},
{{0x44DA9702,0x3F666BD7}},
{{0xEB65BF41,0xBF5E14E0}},
{{0x6440A788,0x3F54347E}}
}
};

db_number const poly_log_fast_l[8][2] =
{
 /* polynome sur le 1 ieme intervalle */
{
{{0xF5B8C149,0x3C68F7E3}},
{{0x7FD6876A,0x3C85D9AD}}
},
 /* polynome sur le 2 ieme intervalle */
{
{{0x2538C850,0xBC6F6652}},
{{0x8401C65A,0xBC7EFDA9}}
},
 /* polynome sur le 3 ieme intervalle */
{
{{0x04C180BE,0x3C21F5AB}},
{{0xE6601A9C,0x3C92F04A}}
},
 /* polynome sur le 4 ieme intervalle */
{
{{0xEC87FF20,0x3C547DBB}},
{{0x3F0AB1E3,0x3C719FCB}}
},
 /* polynome sur le 5 ieme intervalle */
{
{{0x00000000,0x00000000}},
{{0x00000000,0x00000000}}
},
 /* polynome sur le 6 ieme intervalle */
{
{{0xD47979A0,0xBC361A58}},
{{0x1D9E3083,0x3C881724}}
},
 /* polynome sur le 7 ieme intervalle */
{
{{0x66E96EEA,0xBC64F6AC}},
{{0x23FD6EEE,0xBC8AAA98}}
},
 /* polynome sur le 8 ieme intervalle */
{
{{0xB2A221E5,0x3C7F42DE}},
{{0xE95C768F,0xBC7745D0}}
}
};


#endif

