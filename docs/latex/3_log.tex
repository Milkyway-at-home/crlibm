
\newcommand{\middlei}{\mathrm{middle}[i]}


\section{Overview}

The goal is to compute logarithm function so that it provides
correctly rounded result in double precision. The worst-case accuracy
required for this purpose is $118$ bits according to Lefèvre and
Muller \cite{LefMul2004}.

We therefore proceed in two steps as suggested by Ziv \cite{Ziv91}.
The first step (program \texttt{log\_fast.c}) is fast but accurate
only to $59$ bits.  If this is not enough to decide correct rounding,
a second step accurate to $120$ bits is lauched (program
\texttt{log.c}).

Some  of the algorithms and programs that we use are detailed in the
research report RR2003-37 \cite{DarDefDinMul03}, available at
\texttt{www.ens-lyon.fr/LIP/Pub/rr2003.html}.


\subsubsection*{Definition interval and exceptional cases}

The natural logarithm is defined over positive floating point numbers.  

\begin{itemize}
\item If $x < 0$ , then $\log(x)$ should return $NaN$
\item If $x = +\infty$ , then $\log(x)$ should return $+\infty$. 
\end{itemize}

\subsubsection*{Avoiding denormals} 

If $x < 2^{-1022}$ , ie if x is a subnormal number, then we use the equation
$$\log(x) = -52 * \log(2) + \log\left(\frac{x}{2^{-52}}\right)$$ where
$\displaystyle \frac{x}{2^{-52}}$ is now a normalized number.






\section{Quick phase}

\subsection{Description of the algorithm}

The algorithm consists of an argument reduction using the well-known
property of the logarithm, and a polynomial evaluation using a degree
13 polynomial.

\subsubsection{Argument reduction and reconsruction}

It is based around the equation 
\begin{equation}
x = 2^{E} * y \label{eq:argred}
\end{equation}
where $E$ is an integer, and $y$ satisfies
\begin{equation}
\frac{11}{16}<\frac{\sqrt{2}}{2} < y < \sqrt{2}<\frac{23}{16} \quad.
\end{equation}

The final reconstruction will then use the equation
 \begin{equation}
\log(x) = E * \log(2) + \log(y) \quad.
\end{equation}

The interval $[\frac{11}{16},\frac{23}{16}]$ being too large for a
polynomial approximation of acceptable degree, it is broken down into
the following intervals:\\
$[\frac{11}{16},\frac{12}{16}], 
[\frac{12}{16},\frac{13}{16}],
[\frac{13}{16},\frac{14}{16}],
[\frac{14}{16},\frac{15}{16}], 
[\frac{15}{16}, \frac{17}{16}], 
[\frac{17}{16},\frac{19}{16}], 
[\frac{19}{16},\frac{21}{16}], 
[\frac{21}{16},\frac{23}{16}]$

Note that the first four intervals are of size $2^{-4}$, while the
last four are of size $2^{-3}$. 
The value of $i$, the index of the interval $X[i]$ to which $y$
belongs, will be computed out of a few bits of $y$. 

Noting
$\middlei$ the middle of the $i$-th interval, the final range
reduction consists in computing $z = y - \middlei$. On each iterval,
a polynomial $P[i](z)$ approximates $\log(y)$. In the following $P[i]$
will be noted $P$ when no ambiguity arises. Table~\ref{TablePolys}


\subsubsection{Polynomial approximation}

On each interval, we have a polynomial $P(z)$ of degree 13 which approximates
$\log(y)$ with an error less than $2^{-60}$ (Cf  Table~\ref{TablePolys}).
Each polynomial has exact IEEE-double coefficients, with the
particularity that coefficients of degree 0 and 1 are exactly written
over two IEEE-double in order to have more precision: $c_0 = c_0^{hi} +
c_0^{lo}$ and $c1 = c_1^{hi} + c_1^{lo}$:

$$P(z) = c_0^{hi}+c_0^{lo} + z .(c_1^{hi} +c_1^{lo} + z .(c_2 + z
  .(c_3 + ...
% + z .(c_4 + z .(c_5 + z .(c_6 + z .(c_7 + z .(c_8 + z .(c_9 + z .(c_{10} 
+ z .(c_{11} + z . (c_{12} + (c_{13} . z))))))))))))) \quad .
$$




\begin{table}[htdp]\caption{polynomial precision\label{TablePolys}}\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
&&&&\\
polynomial and & interval & value of & max value & relative error $\epsilon_{Th}$ between\\
definition interval & i & $\middlei$ & of $|z|$ & the function and the polynomial. \\
&&&&\\
\hline  
&&&& \\
P[0] over $[\frac{11}{16},\frac{12}{16}]$ & 0 & $\frac{23}{32}$ & $2^{-5}$ & $\epsilon_{-63}$ \\ 
&&&& \\
\hline 
&&&& \\
P[1] over $[\frac{12}{16},\frac{13}{16}]$ & 1 & $\frac{25}{32}$ & $2^{-5}$ & $\epsilon_{-62}$ \\
&&&& \\
\hline 
&&&& \\
P[2] over $[\frac{13}{16},\frac{14}{16}]$ & 2 & $\frac{27}{32}$ & $2^{-5}$ & $\epsilon_{-61}$ \\ 
&&&& \\
\hline 
&&&& \\
P[3] over $[\frac{14}{16},\frac{15}{16}]$ & 3 & $\frac{29}{32}$ & $2^{-5}$ & $\epsilon_{-60,4}$ \\ 
&&&& \\
\hline
&&&& \\
P[4] over $[\frac{15}{16},\frac{17}{16}]$ & 4 & $\frac{31}{32}$ & $2^{-4}$ & $\epsilon_{-62}$ \\ 
&&&& \\
\hline 
&&&& \\
P[5] over $[\frac{17}{16},\frac{19}{16}]$ & 5 & $\frac{18}{16}$ & $2^{-4}$ & $\epsilon_{-60,2}$ \\ 
&&&& \\
\hline 
&&&& \\
P[6] over $[\frac{19}{16},\frac{21}{16}]$ & 6 & $\frac{20}{16}$ & $2^{-4}$ & $\epsilon_{-61}$ \\ 
&&&& \\
\hline 
&&&& \\
P[7] over $[\frac{21}{16},\frac{23}{16}]$ & 7 & $\frac{22}{16}$ & $2^{-4}$ &  $\epsilon_{-63}$ \\ 
&&&& \\
\hline
\end{tabular}\end{center}\end{table}



\subsubsection{Reconstruction}

The reconstruction computes: 
$$\log(x) \approx E\times \log(2) + P(z)$$
where $P(z)$ has been computed by
the previous step as the sum of two double-precision numbers.  The
constant $\log(2)$ is also stored as the sum of two double-precision
numbers, and  $E$ is a relatively small integer. This computation uses double-double
techniques. 

\subsubsection{Rounding test}

The previous evaluation returns an approximation to the logarithm as
the sum of two double-precision numbers.  To test if we are able to
round correctly the result toward $+$ or $- \infty$ or to nearest
(depending of the function call) the same technique is used as for the
exponential \cite{DarDefDinMul03}.









\subsection{Details of computer program}


\subsubsection{Exceptional cases, subnormal numbers}

\begin{lstlisting}[caption={Exceptional cases},firstnumber=1]
  y.d = x;
  /* Filter cases */
  if (y.i[HI_ENDIAN] < 0x00100000){       
    if (((y.i[HI_ENDIAN] & 0x7fffffff)|y.i[LO_ENDIAN])==0){
      return 1.0/0.0;     
    }                                     
    if (y.i[HI_ENDIAN] < 0){ 
      return (x-x)/0;                    
    }
    /* Subnormal number */
    E = -52;            
    y.d *= two52.d;     
    }
    
  if (y.i[HI_ENDIAN] >= 0x7ff00000){
    return  x+x;                                 
  }
\end{lstlisting}


\begin{tabular}{ll}
Line  1 &  initialize y\\
Line 3 & Test if x is null, negative or a subnormal number.\\
Line 4 & Test if x is a NaN or $\infty$ \\
Line 7 & If x is negative, we should return NaN and raise an exception.\\
Line 11 & If $x$ is subnormal, compute:\\
& $log(x) = -52\times log(2) + log(\frac{x}{2^{-52}})$ \\ 
Line 15 & If $x$ is $\infty$ or NaN, return $\infty$ or NaN.\\
\end{tabular}

~\\

At the end of this part, either a result has been returned, or
\texttt{y.d} is a normal number.



\subsubsection{Argument reduction}

There are two argument reductions. The first one consists in finding
$y$ from equation~(\ref{eq:argred}).

\begin{lstlisting}[caption={Exponent computation},firstnumber=1]
/* find y.d such that sqrt(2)/2 < y.d < sqrt(2) */
  E += (y.i[HI_ENDIAN]>>20)-1023;                       
  y.i[HI_ENDIAN] =  (y.i[HI_ENDIAN] & 0x000fffff) | 0x3ff00000; 
  if (y.d > SQRT_2){
    y.d *= 0.5;
    E++;
  }
 \end{lstlisting}

\begin{tabular}{ll}Line 2 & E contains x 's exponent.\\
Line 3 & y.d is reduced to $\frac{x}{2^E}$.\\
Line4 & Now, we have: $ 1 \leq y.d < 2$ and we want $ \frac{1}{\sqrt2} \leq y.d < \sqrt2$.\\
& So, if it's not the case, we correct E and y in order to find y in the correct interval.\\
\end{tabular}

~\\



The second argument reduction consists in finding the interval $X_i$
including y.d, and then calculating z.d, according to equation (3).

\begin{lstlisting}[caption={x second reduction},firstnumber=1]
  /* find the interval including y.d */
  i = (((y.i[HI_ENDIAN] & 0x001F0000)>>16)-6) ; /* 11<= i <= 21*/
  if (i < 10) {
    i = i>>1;
  }
  else{
    i = ((i-1)>>1);
  }
 
  z.d = y.d - (middle[i]).d;    
\end{lstlisting}

\begin{tabular}{ll}
Line 2  & To find the interval $X_i$ containing $y$, 
         we just need to look upon a few bits:\\
        & the last one of exponent and the 4th first of mantissa.\\
Line 3  & Reduction over $i$ in order to have a number $i$ between 0 and 7\\
        & and being able to call the right polynomial among our 8 intervals.\\
Line 10 & Let us prove that z.d is computed exactly, without rounding error. \\
& \vspace{1ex}To use Sterbenz Lemma, we need to prove that  ${\middlei}/{2} <  y.d < \middlei \times 2$.\\ 
& \vspace{1ex}For every i in $[0;7]$, we have $\middlei-\frac{1}{16} \leq y.d \leq \middlei+\frac{1}{16}$.\\
& \vspace{1ex}Table~\ref{TablePolys} gives: $\frac{25}{32} \leq {\middlei} \leq \frac{22}{16}$\\ 
& \vspace{1ex}Therefore ${\middlei}/{2} \leq \frac{22}{32} < \frac{23}{32} \leq \middlei - \frac{1}{16} \leq y.d$\\
& and $y.d \leq \middlei + \frac{1}{16} \leq \frac{23}{16} < \frac{25}{16} \leq \middlei\times 2$\\
\end{tabular}



\subsubsection{Polynomial evaluation}

\begin{lstlisting}[caption={Exponent computation\label{lst:poly}},firstnumber=1]
  res = (poly_log_fast[dicho][13][HI_ENDIAN]).d;
  for(i=12; i>2; i--){
    res *= z.d;
    res += (poly_log_fast[dicho][i][HI_ENDIAN]).d;
  }
 \end{lstlisting}
 
 A bound on the accumulated rounding errors in this computation is
 computed by a Maple procedure detailed in \ref{section:commonMaple},
 and appears in Table~\ref{TablePolys}. For every polynomial, we will
 note $S_2 = (c_{2} + P_{3}) + \epsilon_{-a}+ \epsilon_{-b}$
 
 The end of computation is performed with precise addition and
 multiplication operators, in order not to loose to much precision.

\begin{lstlisting}[caption={End of polynomial computation},firstnumber=1]
   /* P2 = S2 times z  exactly */
 Dekker(&P_hi, &P_lo, res, z.d);
 
  /*add S1 = a1_hi + a1_lo to P2 */ 
  ADD2((poly_log_fast[i][1][HI_ENDIAN]).d,  (poly_log_fast[i][1][LO_ENDIAN]).d, P_hi, P_lo, &reshi.d, &reslo.d);
 
  /* multiply S1 by x = P1 */ 
  Dekker2(reshi.d, reslo.d, z.d, 0., &P_hi, &P_lo);
       
  /* add S0 = a0_hi + a0_lo to P1=P1_hi+P1_lo */
  ADD2((poly_log_fast[i][0][HI_ENDIAN]).d, (poly_log_fast[i][0][LO_ENDIAN]).d, P_hi, P_lo, &reshi.d, &reslo.d);
\end{lstlisting}

\begin{tabular}{ll}
& Procedures Add22, Mul12 and Mul22 are detailed in \ref{section:commonCdoubledouble}\\
Line 2 & $P\_hi + P\_lo$  is exactly the result of the multiplication of "res" by "z.d".\\    
Line 5 & ADD2 does the addition of $P\_hi + P\_lo$ with $c_1hi + c_1lo$ and returns a result over\\ & two IEEE-double precision numbers, with an error less than $2^{-103}$.\\
Line 8 & Dekker2 does the multiplication of $reshi.d + reslo.d$ by $z.d$ and returns a result over\\ & two IEEE-double precision numbers, with an error less than $2^{-103}$.\\
Line 11 & ADD2 does the addition of $P\_hi + P\_lo$ with $c_0hi + c_0lo$ and returns a result over \\
& two IEEE-double precision numbers, with an error less than $2^{-103}$.\\
\end{tabular}

~\\

At the end of the polynomial evaluation, we have :\\
\begin{equation}
  P(z.d) = reshi + reslo + \epsilon_{-a-2\times \maxz} + \epsilon_{-b-2\times \maxz} + 3\times \epsilon_{-103} 
\end{equation}

The approximation error (Cf Table~\ref{TablePolys}) is noted $\epsilon_{-Th}$, so:\\
\begin{equation}
P(z.d) = reshi + reslo +\epsilon_{-a-2\times \maxz} + \epsilon_{-b-2\times \maxz} + 3\times  \epsilon_{-103} + \epsilon_{-Th}
\end{equation}

Now, we give the result of this computation, provided by maple, for each polynomial:\\

$P[0]$ defined over $[\frac{11}{16}; \frac{12}{16}]$:\\
Assume $|y| \leq 2^{-5}$, so $\maxz = 5$\\

$S_2 = (P_3 \oplus c_2) +  \epsilon_{-54} + 2\times \epsilon_{-59} + 2\times \epsilon_{-64} +  2\times \epsilon_{-68} + 2\times \epsilon_{-73} + 2\times \epsilon_{-78} + 2\times \epsilon_{-83} + 2\times \epsilon_{-87} + 2\times \epsilon_{-92} +  2\times \epsilon_{-96} + 2\times \epsilon_{-100} + \epsilon_{-101}$\\
This gives:\\
$P[0](z.d) = reshi + reslo + \epsilon_{-62} + \epsilon_{66} + 3\times \epsilon_{-103} + \epsilon{-63}$\\

$P[1]$ defined over $[\frac{12}{16}; \frac{13}{16}]$:\\
Assume $|y| \leq 2^{-5}$, so $\maxz = 5$\\

$S_2 = (P_3 \oplus c_2) +  \epsilon_{-54} + 2\times \epsilon_{-59} + 2\times \epsilon_{-64} +  2\times \epsilon_{-69} + 2\times \epsilon_{-74} + 2\times \epsilon_{-79} + 2\times \epsilon_{-84} + 2\times \epsilon_{-88} + 2\times \epsilon_{-93} +  2\times \epsilon_{-98} + 2\times \epsilon_{-101} + \epsilon_{-102}$\\
This gives:\\
$P[1](z.d) = reshi + reslo + \epsilon_{-62} + \epsilon_{66} + 3\times \epsilon_{-103} + \epsilon{-62}$\\

$P[2]$ defined over $[\frac{13}{16}; \frac{14}{16}]$:\\
Assume $|y| \leq 2^{-5}$, so $\maxz = 5$\\

$S_2 = (P_3 \oplus c_2) +  \epsilon_{-54} + 2\times \epsilon_{-59} + 2\times \epsilon_{-64} +  2\times \epsilon_{-70} + 2\times \epsilon_{-75} + 2\times \epsilon_{-80} + 2\times \epsilon_{-84} + 2\times \epsilon_{-89} + 2\times \epsilon_{-94} +  2\times \epsilon_{-99} + 2\times \epsilon_{-103} + \epsilon_{-104}$\\
This gives:\\
$P[2](z.d) = reshi + reslo + \epsilon_{-62} + \epsilon_{66} + 3\times \epsilon_{-103} + \epsilon{-61}$\\

$P[3]$ defined over $[\frac{14}{16}; \frac{15}{16}]$:\\
Assume $|y| \leq 2^{-5}$, so $\maxz = 5$\\

$S_2 = (P_3 \oplus c_2) +  \epsilon_{-54} + 2\times \epsilon_{-60} + 2\times \epsilon_{-65} +  2\times \epsilon_{-70} + 2\times \epsilon_{-75} + 2\times \epsilon_{-80} + 2\times \epsilon_{-85} + 2\times \epsilon_{-90} + 2\times \epsilon_{-95} +  2\times \epsilon_{-99} + 2\times \epsilon_{-100} + \epsilon_{-103}$\\
This gives:\\
$P[3](z.d) = reshi + reslo + \epsilon_{-62} + \epsilon_{67} + 3\times \epsilon_{-103} + \epsilon{-60.4}$\\



$P[4]$ defined over $[\frac{15}{16}; \frac{17}{16}]$:\\
Assume $|y| \leq 2^{-4}$, so $\maxz = 4$\\

$S_2 = (P_3 \oplus c_2) +  \epsilon_{-54} + 2\times \epsilon_{-59} + 2\times \epsilon_{-63} +  2\times \epsilon_{-68} + 2\times \epsilon_{-72} + 2\times \epsilon_{-76} + 2\times \epsilon_{-80} + 2\times \epsilon_{-85} + 2\times \epsilon_{-89} +  2\times \epsilon_{-93} + 2\times \epsilon_{-97} + \epsilon_{-101}$\\
This gives:\\
$P[4](z.d) = reshi + reslo + \epsilon_{-62} + \epsilon_{66} + 3\times \epsilon_{-103} + \epsilon{-62}$\\


$P[5]$ defined over $[\frac{17}{16}; \frac{19}{16}]$:\\
Assume $|y| \leq 2^{-4}$, so $\maxz = 4$\\

$S_2 = (P_3 \oplus c_2) +  \epsilon_{-55} + 2\times \epsilon_{-60} + 2\times \epsilon_{-64} +  2\times \epsilon_{-69} + 2\times \epsilon_{-73} + 2\times \epsilon_{-77} + 2\times \epsilon_{-82} + 2\times \epsilon_{-86} + 2\times \epsilon_{-90} +  2\times \epsilon_{-94} + 3\times \epsilon_{-98}$\\
This gives:\\
$P[5](z.d) = reshi + reslo + \epsilon_{-63} + \epsilon_{67} + 3\times \epsilon_{-103} + \epsilon{-60.2}$\\


$P[6]$ defined over $[\frac{19}{16}; \frac{21}{16}]$:\\
Assume $|y| \leq 2^{-4}$, so $\maxz = 4$\\

$S_2 = (P_3 \oplus c_2) +  \epsilon_{-55} + 2\times \epsilon_{-60} + 2\times \epsilon_{-65} +  2\times \epsilon_{-69} + 2\times \epsilon_{-74} + 2\times \epsilon_{-78} + 2\times \epsilon_{-83} + 2\times \epsilon_{-88} + 2\times \epsilon_{-92} +  2\times \epsilon_{-96} + 2\times \epsilon_{-99} + \epsilon_{-100}$\\
This gives:\\
$P[6](z.d) = reshi + reslo + \epsilon_{-63} + \epsilon_{67} + 3\times \epsilon_{-103} + \epsilon{-61}$\\


$P[7]$ defined over $[\frac{21}{16}; \frac{23}{16}]$:\\
Assume $|y| \leq 2^{-4}$, so $\maxz = 4$\\

$S_2 = (P_3 \oplus c_2) +  \epsilon_{-55} + 2\times \epsilon_{-60} + 2\times \epsilon_{-65} +  2\times \epsilon_{-70} + 2\times \epsilon_{-75} + 2\times \epsilon_{-79} + 2\times \epsilon_{-84} + 2\times \epsilon_{-89} + 3\times \epsilon_{-93} +  2\times \epsilon_{-98} + 2\times \epsilon_{-103}$\\
This gives:\\
$P[7](z.d) = reshi + reslo + \epsilon_{-63} + \epsilon_{67} + 3\times \epsilon_{-103} + \epsilon{-63}$\\



\subsubsection{Rebuilding}
\begin{lstlisting}[caption={Round test},firstnumber=1]
  if (!(E==0)){
  
  /*  sc_ln2_times_E = E*log(2)  */
  Dekker2(ln2hi.d, ln2lo.d, E * 1., 0., &ln2_times_E_HI, &ln2_times_E_LO);
   
   /* REBUILDING */
   ADD2(ln2_times_E_HI, ln2_times_E_LO, reshi, reslo, &reshi, &reslo);
}
\end{lstlisting}

\begin{tabular}{ll}
Line 1 & Test if E is different from 0, ie test if we need to compute $ E\times log(2)$\\
Line 4 & Dekker2 multiply log(2) by E with an error less than $2^{-103}$. Result is written over\\
& two IEEE-double numbers.\\
Line 7 & ADD2 realize the addition of terms from equation (4) and put the result in $reshi + reslo$.\\ 
& The error is again less than $2^{-103}$.\\
\end{tabular}

~\\

Finally, in the worst case, we have:\\
\begin{equation}\log(x) = reshi + reslo + \epsilon_{-63} + \epsilon_{67} + 5\times \epsilon_{-103} + \epsilon{-60}\\\end{equation}
That is to say:\\
\begin{equation}\log(x) = (reshi + reslo) \times  (1+ \epsilon_{-59})\\\end{equation}

\newpage
\subsection{Rounding test}

For more details ( round toward $\pm \infty$), see RR2003-37.pdf, paragraph 3.3.\\
\begin{lstlisting}[caption={Code},firstnumber=1]
   /*  ROUNDING TO NEAREST */
   
  if(reshi == (reshi + (reslo * (1.0078125)))){ /*  2^-7 = 0.0078125 */
     return reshi;
  }else{
     return scs_log_rn(y, E);
  }

\end{lstlisting}

\begin{tabular}{ll}
Line 3 & Assuming that reshi is the rounded to nearest result from $reshi + reslo$,\\
& test to detect if a small disruption does not change the rounded result\\
Line 4 & then reshi is the correct rounded result.\\
Line 5 & else, it means that we must compute with more accuracy log(x).\\
Line 6 & This is the reason why we call scs\_log\_rn.\\
\end{tabular}






\section{Accurate phase}


The function called is \texttt{scs\_log\_rn} for a result rounded to
nearest, \texttt{scs\_log\_rd} for rounding down, or
\texttt{scs\_log\_ru} for rounding up.



\subsection{Argument reduction}

Argument reduction is the same as in the first step: 
$x = 2^E \times y$,
with $y = 1 + f$, $f \leq 2^{-1}$
and  $\frac{1}{\sqrt(2)} \leq y < sqrt(2)$

Therefore the \texttt{scs\_log\_*} functions take as arguments $y$ and $E$, computed
in the first step (similarly, exceptional cases are not considered
again).

As in the first step we will compute the log using $$\log(x) = E \times log(2) + log(1+f)\quad .$$

Now we define $w_i = 1 + i\times2^{-4}$, for $i = -6 ... 6$, and we select the $w_i$ closest to $1+f$, in order to have: 

$$log(1+f) = log(w_i) + log(1+\frac{1+f-w_i}{w_i})$$

where $r=\frac{1+f-w_i}{w_i} \leq 2^{-5}$.


\begin{lstlisting}[caption={Argument reduction},firstnumber=1]
 /* to normalize y.d and round to nearest      */
  /* + (1-trunc(sqrt(2.)/2 * 2^(4))*2^(-4) )+2.^(-(4+1))*/ 
  z.d = y.d + norm_number.d; 
  i = (z.i[HI_ENDIAN] & 0x000fffff);
  i = i >> 16; /* 0<= i <=11 */
  

  wi.d = (11+i)*(double)0.6250e-1;

  /* (1+f-w_i) */
  y.d -= wi.d; 
  
  /* Table reduction */
  ti     = table_ti_ptr[i]; 
  inv_wi = table_inv_wi_ptr[i];
   
  /* R = (1+f-w_i)/w_i */
  scs_set_d(R, y.d);
  scs_mul(R, R, inv_wi);

\end{lstlisting}

\begin{tabular}{ll}
Lines 3-5 & We compute the "i" corresponding to z, through the four first bits of z's mantissa.\\
Line 7 & $w_i$ is computed.\\
Lines 14-15 & We get tabulated values: $t_i = log(w_i)$ and $\frac{1}{w_i}$\\
Lines 18-19 & We compute the polynomial argument: $R = \frac{1+f-w_i}{w_i}$.\\ 
\end{tabular}



\subsection{Polynomial approximation}
$log(1+\frac{1+f-w_i}{w_i})$ is approximated by  a polynomial $Q(\frac{1+f-w_i}{w_i})$ with an error less than $2^{-130}$.

$log(w_i)$ and $log(2)$ are tabulated. The polynomials are given in appendix


The computation is similar as the first step computation, except that everything is computed in SCS format, it means that every computation is realized with 211 bits precision.
so it is clearly enough to reach a result with 130 bits precision.\\



\subsection{Reconstruction}
So, at the end, we compute:\\
\begin{equation}result = E\times log(2) + log(w_i) + Q(\frac{1+f-w_i}{w_i})\end{equation}


\subsection{Rounding mode}
The procedures $scs\_get\_d$, $scs\_get\_d\_pinf$ and $scs\_get\_d\_minf$ assure the conversion from type "scs" to type "IEEE" according to the selected round mode.\\
You are encouraged for further details to have a look at the research report RR 2003-37.pdf at www.ens-lyon.fr/LIP/Pub/rr2003.html




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Analysis of the logarithm performance}
\label{section:log_results}

Table \ref{tbl:log_abstime} (produced by the \texttt{crlibm\_testperf}
executable) gives absolute timings for a variety of processors and
operating systems. Contributions to this table for new
processors/OS/compiler combinations are welcome.

\begin{table}[!htb]
\begin{center}
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|l|r|r|r||r|}
\hline\hline
 \multicolumn{4}{|c|}{Pentium 4 Xeon / Debian sarge / gcc 3.3}   \\ 
 \hline
                         & min time      & max time      & avg time \\ 
 \hline
 \texttt{libm}           & 728          & 33196         &        892 \\ 
 \hline
  \texttt{mpfr}          & 748          & 242592        &      22604 \\ 
 \hline
  \texttt{libultim}      & 968          & 419528        &       1289 \\ 
 \hline\hline
 \texttt{crlibm}         & 1472         & 52828         &       1837 \\ 
 \hline\hline
\end{tabular}
\end{center}
\caption{Absolute timings for the logarithm
  \label{tbl:log_abstime}}
\end{table}


In average, the second step is taken in 0.4\% of the calls, which
seems a rather good balance considering the respective costs of the
first and second steps (seen in the table as the min and max times,
respectively).




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusion and perspectives}


In the log we have a fairly good balance between both evaluation
phases. The IBM library has specific code for the cases when $x$ is
close to $1$. By following this approach we can hope for a further
50\% performance improvement in average, at the cost of a more
complicated proof.





%% \section{Second step polynomial coefficients.}

%% \begin{table}
%% \caption{Polynomial P 0} 
%% \begin{tabular}{|c|c|c|c|}
%% \hline &&& \\
%% coeff n° & exponent & mantissa & binary number \\ 
%% &&&\\ \hline &&& \\ 
%% 0 HI &$ -2 $ & $\frac{-743638168966267}{562949953421312}$ & $ -.10101001000101010111000000111001110001010001111011000e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 0 LO &$ -57 $ & $\frac{7027957893218633}{4503599627370496}$ & $ .11000111101111110001111110101101110001100000101001000e-56 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 HI &$ 0 $ & $\frac{1566469435607129}{1125899906842624}$ & $ 1.0110010000101100100001011001000010110010000101100100 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 LO &$ -55 $ & $\frac{3075156854129589}{2251799813685248}$ & $ .10101110110011010110101111111110101101000011101101001e-54 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 2 &$ -1 $ & $\frac{-8717742945987501}{4503599627370496}$ & $ -.11110111110001011110110110011100010011110101110101101 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 3 &$ -1 $ & $\frac{8086022442655257}{4503599627370496}$ & $ .11100101110100011000111001111010101110001111000011001 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 4 &$ -1 $ & $\frac{-1054698579476787}{562949953421312}$ & $ -.11101111110011111000100110001011001100000100110011000 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 5 &$ 0 $ & $\frac{4695701500917009}{4503599627370496}$ & $ 1.0000101011101011011100110011111011101111010100010001 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 6 &$ 0 $ & $\frac{-5444291595459813}{4503599627370496}$ & $ -1.0011010101111000110111101010100110011101110011100101 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 7 &$ 0 $ & $\frac{3246286994737197}{2251799813685248}$ & $ 1.0111000100001111011000101110010100100001000001011010 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 8 &$ 0 $ & $\frac{-1976000318188175}{1125899906842624}$ & $ -1.1100000101001010010110110100001010101010101000111100 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 9 &$ 1 $ & $\frac{4885240473419053}{4503599627370496}$ & $ 10.001010110110001100110101111000011110111110100101101 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 10 &$ 1 $ & $\frac{-382458832789537}{281474976710656}$ & $ -10.101101111011000001000101101111010100000001000010000 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 11 &$ 2 $ & $\frac{299676142110095}{281474976710656}$ & $ 100.01000010001101110010011111111110000101100011110000 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 12 &$ 2 $ & $\frac{-5063189123827543}{4503599627370496}$ & $ -100.01111111001111000110010101001010000000011101010111 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 13 &$ 7 $ & $\frac{-8903658134248167}{4503599627370496}$ & $ -11111101.000011101010001110100010010110001101011100111 $ \\ 
%% &&&\\ \hline
%% \end{tabular}
%% \end{table}

%% \begin{table}
%% \caption{Polynomial P 1} 
%% \begin{tabular}{|c|c|c|c|}
%% \hline &&&\\
%% coeff n°& exponent & mantissa & binary number \\ 
%% &&&\\ \hline &&& \\ 
%% 0 HI &$ -3 $ & $\frac{-8894071639880569}{4503599627370496}$ & $ -.11111100110010001110001101100101100111011001101111000e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 0 LO &$ -57 $ & $\frac{-552389204741253}{281474976710656}$ & $ -.11111011001100101001000100101001110001100100001001111e-56 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 HI &$ 0 $ & $\frac{5764607523034235}{4503599627370496}$ & $ 1.0100011110101110000101000111101011100001010001111011 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 LO &$ -56 $ & $\frac{-4361576903664429}{2251799813685248}$ & $ -.11110111111011010100110000100000000011100011001011001e-55 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 2 &$ -1 $ & $\frac{-7378697629483821}{4503599627370496}$ & $ -.11010001101101110001011101011000111000100001100101101 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 3 &$ -1 $ & $\frac{3148244321913127}{2251799813685248}$ & $ .10110010111101001111110000000111100101001001001001110 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 4 &$ -1 $ & $\frac{-6044629098073239}{4503599627370496}$ & $ -.10101011110011000111011100010001100001000110010010111 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 5 &$ -1 $ & $\frac{1547425048982465}{1125899906842624}$ & $ .10101111111010111111111100001011100011100111100000100 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 6 &$ -1 $ & $\frac{-3301173437887807}{2251799813685248}$ & $ -.10111011101001100110010101100001101101110101001111110 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 7 &$ -1 $ & $\frac{7243719460619263}{4503599627370496}$ & $ .11001101111000001111111011101010011011000001111111111 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 8 &$ -1 $ & $\frac{-4056482338782501}{2251799813685248}$ & $ -.11100110100101011001011001001101011100111101001001010 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 9 &$ 0 $ & $\frac{144183934662417}{140737488355328}$ & $ 1.0000011001000100111000000110101001101110001000100000 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 10 &$ 0 $ & $\frac{-664564121389669}{562949953421312}$ & $ -1.0010111000110101011100100011000101100101001100101000 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 11 &$ 0 $ & $\frac{7406777826722191}{4503599627370496}$ & $ 1.1010010100000110110011011001010010101100000110001111 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 12 &$ 0 $ & $\frac{-1853617081185135}{1125899906842624}$ & $ -1.1010010101110110101101101110101100011100110110111100 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 13 &$ 6 $ & $\frac{-1467725186095279}{1125899906842624}$ & $ -1010011.0110111000110110011001011000010110001010111100 $ \\ 
%% &&&\\ \hline &&& \\ 
%% \end{tabular}
%% \end{table}

%% \begin{table}
%% \caption{Polynomial P 2} 
%% \begin{tabular}{|c|c|c|c|}
%% \hline &&& \\
%% coeff n°& exponent & mantissa & binary number \\ 
%% &&&\\ \hline &&& \\ 
%% 0 HI &$ -3 $ & $\frac{-3060628955209433}{2251799813685248}$ & $ -.10101101111110100000001101011010101000011110110110001e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 0 LO &$ -61 $ & $\frac{2527594736042079}{2251799813685248}$ & $ .10001111101011010101100000100110000011000000010111110e-60 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 HI &$ 0 $ & $\frac{667199944795629}{562949953421312}$ & $ 1.0010111101101000010010111101101000010010111101101000 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 LO &$ -54 $ & $\frac{1332688516023975}{1125899906842624}$ & $ .10010111100000100101011100110011000000001101010011100e-53 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 2 &$ -1 $ & $\frac{-6326043921025223}{4503599627370496}$ & $ -.10110011110011000000011100000101111110000100011000111 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 3 &$ -1 $ & $\frac{2499177845343309}{2251799813685248}$ & $ .10001110000011111101001011111011001111000100010011010 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 4 &$ -2 $ & $\frac{-8885965672331789}{4503599627370496}$ & $ -.11111100100011011110100011011011000101011101000001100e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 5 &$ -2 $ & $\frac{8425211896372323}{4503599627370496}$ & $ .11101111011101010111110000010001111011001110001100011e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 6 &$ -2 $ & $\frac{-8321196934766279}{4503599627370496}$ & $ -.11101100100000001010110100011011001110001111011000111e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 7 &$ -2 $ & $\frac{8453280679506371}{4503599627370496}$ & $ .11110000010000011011011001000000101101011000111000011e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 8 &$ -2 $ & $\frac{-4383182203135729}{2251799813685248}$ & $ -.11111001001001111011001000100011010000100110111100010e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 9 &$ -1 $ & $\frac{4616603552660769}{4503599627370496}$ & $ .10000011001101100011011000110110100110011110100100001 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 10 &$ -1 $ & $\frac{-4925251927700411}{4503599627370496}$ & $ -.10001011111110111110110010011100101000111001110111011 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 11 &$ -1 $ & $\frac{6183144258300187}{4503599627370496}$ & $ .10101111101111000100101110101000111000110100100011011 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 12 &$ -1 $ & $\frac{-366830079310573}{281474976710656}$ & $ -.10100110110100001010010001001000111111010111011010000 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 13 &$ 4 $ & $\frac{-2107375484601665}{1125899906842624}$ & $ -11101.111100101001011001011100101011000001010100000100 $ \\ 
%% &&&\\ \hline 
%% \end{tabular}
%% \end{table}


%% \begin{table}
%% \caption{Polynomial P 3} 
%% \begin{tabular}{|c|c|c|c|}
%% \hline &&& \\
%% coeff n°& exponent & mantissa & binary number \\ 
%% &&&\\ \hline &&& \\ 
%% 0 HI &$ -4 $ & $\frac{-7093354803841417}{4503599627370496}$ & $ -.11001001100110101111001011101010110010100100110001000e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 0 LO &$ -58 $ & $\frac{180242050465785}{140737488355328}$ & $ .10100011111011011101111101100100001111111111100011111e-57 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 HI &$ 0 $ & $\frac{2484744621997515}{2251799813685248}$ & $ 1.0001101001111011100101100001000110100111101110010110 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 LO &$ -56 $ & $\frac{4960769888924131}{4503599627370496}$ & $ .10001100111111100101100111111000010101011000111100011e-55 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 2 &$ -1 $ & $\frac{-5483574338201415}{4503599627370496}$ & $ -.10011011110110100100000100100100001110010011101000111 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 3 &$ -2 $ & $\frac{1008473441508307}{562949953421312}$ & $ .11100101010011001110000101001111110001101111010011000e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 4 &$ -2 $ & $\frac{-3338394840820967}{2251799813685248}$ & $ -.10111101110001000000100111101001101101101100111001110e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 5 &$ -2 $ & $\frac{5893993650002925}{4503599627370496}$ & $ .10100111100001000111001010101110100010001101111101100e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 6 &$ -2 $ & $\frac{-2709882287004295}{2251799813685248}$ & $ -.10011010000010011111101000110001100110011010100001110e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 7 &$ -2 $ & $\frac{5126082608473109}{4503599627370496}$ & $ .10010001101100010010100011100111101111010010000010100e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 8 &$ -2 $ & $\frac{-2474366161612937}{2251799813685248}$ & $ -.10001100101001101100010001000001101101110000100010010e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 9 &$ -2 $ & $\frac{606794337740459}{562949953421312}$ & $ .10001001111110000001010000111100111110011010101011000e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 10 &$ -2 $ & $\frac{-2678423821842551}{2251799813685248}$ & $ -.10011000010000000011001001000111010101111000011101110e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 11 &$ -2 $ & $\frac{4901274782692199}{4503599627370496}$ & $ .10001011010011010111011110110010111100111001101100111e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 12 &$ 3 $ & $\frac{5562257110400349}{4503599627370496}$ & $ 1001.1110000101101011111100111001101101111110101011101 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 13 & $ 0 $ & $ 0 $ & $ 0 $ \\ 
%% &&&\\ \hline 
%% \end{tabular}
%% \end{table}



%% \begin{table}
%% \caption{Polynomial P 4} 
%% \begin{tabular}{|c|c|c|c|}
%% \hline &&& \\
%% coeff n°& exponent & mantissa & binary number \\ 
%% &&&\\ \hline &&& \\ 
%% 0 HI & $ 0 $ & $ 0 $ & $ 0 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 0 LO & $ 0 $ & $ 0 $ & $ 0 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 HI & $ 0 $ & $ 1 $ & $ 1. $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 LO &$ -73 $ & $\frac{4866424671436317}{4503599627370496}$ & $ .10001010010011111110011001001110111011111111000011100e-72 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 2 & $ -1 $ & $ -1 $ & $ -.10000000000000000000000000000000000000000000000000000 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 3 &$ -2 $ & $\frac{6004799503160661}{4503599627370496}$ & $ .10101010101010101010101010101010101010101010101010100e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 4 &$ -2 $ & $\frac{-4503599627370601}{4503599627370496}$ & $ -.10000000000000000000000000000000000000000000001101000e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 5 &$ -3 $ & $\frac{7205759403793217}{4503599627370496}$ & $ .11001100110011001100110011001100110011001101101000000e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 6 &$ -3 $ & $\frac{-1501199875682485}{1125899906842624}$ & $ -.10101010101010101010101010101010011101100001011010100e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 7 &$ -3 $ & $\frac{5146971002059239}{4503599627370496}$ & $ .10010010010010010010010010010001111110011100111100111e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 8 &$ -3 $ & $\frac{-1125900001289929}{1125899906842624}$ & $ -.10000000000000000000000010110100001001001101100100100e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 9 &$ -4 $ & $\frac{8006400287554951}{4503599627370496}$ & $ .11100011100011100011101010101000100011011110110000110e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 10 &$ -4 $ & $\frac{-3602718697199167}{2251799813685248}$ & $ -.11001100110010100111010100000010110000010110001111110e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 11 &$ -4 $ & $\frac{818791763735267}{562949953421312}$ & $ .10111010001010111111010000001110001111001011100011000e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 12 &$ -4 $ & $\frac{-6070595428018661}{4503599627370496}$ & $ -.10101100100010010110010100100000011111110100111100100e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 13 &$ -4 $ & $\frac{2804528659819663}{2251799813685248}$ & $ .10011111011010110100001101101000011111101100100011110e-3 $ \\ 
%% &&&\\ \hline
%% \end{tabular}
%% \end{table}


%% \begin{table}
%% \caption{Polynomial P 5} 
%% \begin{tabular}{|c|c|c|c|}
%% \hline &&& \\
%% coeff n°& exponent & mantissa & binary number \\ 
%% &&&\\ \hline &&& \\ 
%% 0 HI &$ -4 $ & $\frac{4243581083941235}{2251799813685248}$ & $ .11110001001110000011101101110001010101111001011100110e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 0 LO &$ -60 $ & $\frac{-194419322244045}{140737488355328}$ & $ -.10110000110100101100011010100011110010111100110100000e-59 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 HI &$ -1 $ & $\frac{2001599834386887}{1125899906842624}$ & $ .11100011100011100011100011100011100011100011100011100 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 LO &$ -55 $ & $\frac{6780843324223619}{4503599627370496}$ & $ .11000000101110010010000011101100111100011000010000011e-54 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 2 &$ -2 $ & $\frac{-222399981598543}{140737488355328}$ & $ -.11001010010001011000011111100110101101110100111100000e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 3 &$ -3 $ & $\frac{4217362614017791}{2251799813685248}$ & $ .11101111101110101011010000000111111101011110111111110e-2 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 4 &$ -3 $ & $\frac{-2811575076012255}{2251799813685248}$ & $ -.10011111110100011100110101011010101001000000110111110e-2 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 5 &$ -4 $ & $\frac{3998684548554481}{2251799813685248}$ & $ .11100011010011001000010011000001010111011110111100001e-3 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 6 &$ -4 $ & $\frac{-2961988555123393}{2251799813685248}$ & $ -.10101000010111101001101100111010100000101010110000001e-3 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 7 &$ -4 $ & $\frac{4513513385732155}{4503599627370496}$ & $ .10000000010010000010000111010000010111010100000111011e-3 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 8 &$ -5 $ & $\frac{-7021014623365341}{4503599627370496}$ & $ -.11000111100011001001101011010100101101010100011011101e-4 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 9 &$ -5 $ & $\frac{5541480771625565}{4503599627370496}$ & $ .10011101011111111001010001000111011000010001001011101e-4 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 10 &$ -6 $ & $\frac{-138651326119215}{70368744177664}$ & $ -.11111100001101001000111000010100111110100101111000000e-5 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 11 &$ -5 $ & $\frac{2405838712720693}{2251799813685248}$ & $ .10001000110000011000111110011101101111001101001101001e-4 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 12 &$ -6 $ & $\frac{-3033201869659221}{2251799813685248}$ & $ -.10101100011010101110010101111111100100011100010101010e-5 $ \\ 
%% &&&\\ \hline &&&\\ 
%% 13 &$ -1 $ & $\frac{-5882258564419063}{4503599627370496}$ & $ -.10100111001011110001000001100001101011000110111110111 $ \\ 
%% &&&\\ \hline 
%% \end{tabular}
%% \end{table}


%% \begin{table}
%% \caption{Polynomial P 6} 
%% \begin{tabular}{|c|c|c|c|}
%% \hline &&& \\
%% coeff n°& exponent & mantissa & binary number \\ 
%% &&&\\ \hline &&& \\ 
%% 0 HI &$ -3 $ & $\frac{4019796858195217}{2251799813685248}$ & $ .11100100011111111011111000111100110101001101000100001e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 0 LO &$ -57 $ & $\frac{-2950359927797621}{2251799813685248}$ & $ -.10100111101101010110001100110111010010110111011101001e-56 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 HI &$ -1 $ & $\frac{3602879701896397}{2251799813685248}$ & $ .11001100110011001100110011001100110011001100110011010 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 LO &$ -55 $ & $\frac{-3752959905019767}{2251799813685248}$ & $ -.11010101010101001100000100011111111010110111011101110e-54 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 2 &$ -2 $ & $\frac{-5764607523034235}{4503599627370496}$ & $ -.10100011110101110000101000111101011100001010001111011e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 3 &$ -3 $ & $\frac{6148914691236995}{4503599627370496}$ & $ .10101110110000110011111000011111011001110010010000011e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 4 &$ -4 $ & $\frac{-7378697629484743}{4503599627370496}$ & $ -.11010001101101110001011101011000111000100011011000110e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 5 &$ -4 $ & $\frac{4722366480912847}{4503599627370496}$ & $ .10000110001101111011110100000100110000001000111001111e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 6 &$ -5 $ & $\frac{-393530540111015}{281474976710656}$ & $ -.10110010111101001111110000000110100110100101001110000e-4 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 7 &$ -6 $ & $\frac{4317595647888997}{2251799813685248}$ & $ .11110101011011010100100100101110000001001110011001010e-5 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 8 &$ -6 $ & $\frac{-6044631180159527}{4503599627370496}$ & $ -.10101011110011000111101011110010010101010101000100111e-5 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 9 &$ -7 $ & $\frac{8590943574074681}{4503599627370496}$ & $ .11110100001010110101011101100000001001010010100111000e-6 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 10 &$ -7 $ & $\frac{-6188699963576117}{4503599627370496}$ & $ -.10101111111001001011011111110111100110100111100110101e-6 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 11 &$ -7 $ & $\frac{5702144446736261}{4503599627370496}$ & $ .10100010000100001000111110110001101001010011110000100e-6 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 12 &$ -8 $ & $\frac{-424997866135913}{281474976710656}$ & $ -.11000001010001000100001101101011101100001011010001111e-7 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 13 &$ -3 $ & $\frac{-5757341135212823}{4503599627370496}$ & $ -.10100011101000100010101110001001101110001000100010111e-2 $ \\ 
%% &&&\\ \hline 
%% \end{tabular}
%% \end{table}


%% \begin{table}
%% \caption{Polynomial P 7} 
%% \begin{tabular}{|c|c|c|c|}
%% \hline &&& \\
%% coeff n°& exponent & mantissa & binary number \\ 
%% &&&\\ \hline &&& \\
%% 0 HI &$ -2 $ & $\frac{2868376209600353}{2251799813685248}$ & $ .10100011000011000101111000010000111000101111011000010e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 0 LO &$ -56 $ & $\frac{8799248525173221}{4503599627370496}$ & $ .11111010000101101111010110010101000100010000111100100e-55 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 HI &$ -1 $ & $\frac{3275345183542179}{2251799813685248}$ & $ .10111010001011101000101110100010111010001011101000110 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 1 LO &$ -56 $ & $\frac{-6555200597316529}{4503599627370496}$ & $ -.10111010010011110101110010011000010001101001110110001e-55 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 2 &$ -2 $ & $\frac{-297758653049289}{281474976710656}$ & $ -.10000111011001111010101101011111001101001110010010000e-1 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 3 &$ -3 $ & $\frac{2309885308503577}{2251799813685248}$ & $ .10000011010011010100000101010100100100000110000110001e-2 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 4 &$ -4 $ & $\frac{-5039749764007811}{4503599627370496}$ & $ -.10001111001111010000000101110011100001100011110000011e-3 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 5 &$ -5 $ & $\frac{1466109022249467}{1125899906842624}$ & $ .10100110101011010110001101101111001001000011111101100e-4 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 6 &$ -6 $ & $\frac{-7108407380574949}{4503599627370496}$ & $ -.11001010000010000111100010000110101101000001011100101e-5 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 7 &$ -7 $ & $\frac{8862430084207537}{4503599627370496}$ & $ .11111011111000101010101001101000001000001001110110001e-6 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 8 &$ -7 $ & $\frac{-5639728263573257}{4503599627370496}$ & $ -.10100000010010100110110001111110001111010111100001000e-6 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 9 &$ -8 $ & $\frac{3645840892850449}{2251799813685248}$ & $ .11001111001111011111011110110101001101110001000100010e-7 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 10 &$ -8 $ & $\frac{-2386362174521563}{2251799813685248}$ & $ -.10000111101001100010001111011011011111000000110110110e-7 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 11 &$ -9 $ & $\frac{3173561151701001}{2251799813685248}$ & $ .10110100011001010110010010010001111011000000000010010e-8 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 12 &$ -10 $ & $\frac{-8467205555863361}{4503599627370496}$ & $ -.11110000101001110000011101011011001011011111101000000e-9 $ \\ 
%% &&&\\ \hline &&& \\ 
%% 13 & $ 0 $ & $ 0 $ & $ 0 $ \\ 
%% &&&\\ \hline 
%% \end{tabular}
%% \end{table}

%% Erreurs approx

%% P0:
%% -63.0335561543503153519561060236275821115193176282828598936000091969791396082118533396$

%% P1:
%% -62.1442297174139549747120885846224119378071897891851912972827117256112491790838501306$

%% P2:
%% -61.2333262205549290003996733087260577169790459154067176452546458667687388357147177354$

%% P3:
%% -60.4190986335205152072260108229699448188586300049015401437646252096816380253547811958$

%% P4:
%% -62.9461911106917443178043861037065674873169791834709346433334048487967658174065656673$

%% P5:
%% -60.2165945189274221232763599838279416602051132104701245665550547127176437549725373247$

%% P6:
%% -61.6071069727527318902661883152800182616307327795335555694099125712238629376830307421$

%% P7:
%% -63.0374421600999012862137048917495991411594406510710431721052393396795383773111066083$


